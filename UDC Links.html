<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>UDC Links</title>
<style>
body { font-family: Arial, sans-serif; background-color: #f9fafb; color: #111827; margin: 20px; line-height: 1.6; transition: all 0.3s; }
h2 { text-align: center; font-size: 28px; color: #1e3a8a; }
h3 { margin-top: 30px; color: #2563eb; }
h4 { margin-top: 20px; color: #1d4ed8; transition: color 0.3s; }
a { display: inline-block; margin: 5px 5px 5px 0; padding: 8px 12px; border-radius: 6px; text-decoration: none; background: #e5e7eb; color: #111827; transition: all 0.3s ease; }
a:hover { background: #2563eb; color: #fff; transform: translateX(4px); }
hr { margin: 30px 0; border: none; border-top: 2px solid #e5e7eb; }
.btn-darkmode { display: block; margin: 20px auto; padding: 10px 20px; border: none; border-radius: 8px; background: #2563eb; color: #fff; font-size: 14px; cursor: pointer; transition: background 0.3s ease; }
.btn-darkmode:hover { background: #1e40af; }
body.dark { background-color: #111827; color: #f3f4f6; }
body.dark a { background: #374151; color: #f3f4f6; }
body.dark a:hover { background: #16a34a; color: #fff; }
body.dark h4 { color: #93c5fd; }
#fechas { padding: 15px; background: #f3f4f6; border-radius: 8px; margin-top: 20px; transition: all 0.3s; }
body.dark #fechas { background: #1f2937; }
.materia { margin-bottom: 30px; }
.tp { color: #facc15; }         /* amarillo TP/trabajo */
.tp-entregado { color: #16a34a; } /* verde TP entregado/finalizado */
.examen { color: #dc2626; }     /* rojo Parcial/Final/Examen */
.eventos { margin-top: 10px; }
#fileButton, #updateButton, #saveButton { display: inline-block; padding: 10px 20px; border-radius: 8px; background: #2563eb; color: #fff; cursor: pointer; border: none; margin-top: 10px; transition: background 0.3s; }
#fileButton:hover, #updateButton:hover, #saveButton:hover { background: #1e40af; }
#fileInput { display: none; }
#editor { width: 100%; height: 200px; margin-top: 10px; border-radius: 8px; padding: 10px; font-family: monospace; }
#editor:disabled { background: #e5e7eb; color: #6b7280; }
</style>
</head>
<body class="dark">

<h2>EQUIVALENCIASSSSSS!!!!!</h2>
<button class="btn-darkmode" id="toggleDark">‚òÄÔ∏è Modo Claro</button>
<hr>

<h3>Links UDC</h3>
<a target="_blank" href="https://campus.udc.edu.ar/my/">Campus</a>
<a target="_blank" href="https://autogestion.udc.edu.ar/udc/inicio_alumno">Autogestion (SIU Guaran√≠)</a>
<hr>

<h3>Fechas importantes por materia</h3>

<button id="fileButton">Subir "UDC Fechas.txt"</button>
<input type="file" id="fileInput" accept=".txt">
<textarea id="editor" placeholder="O edita aqu√≠ tu UDC Fechas.txt" disabled></textarea>
<br>
<button id="updateButton" disabled>Actualizar</button>
<button id="saveButton" disabled>Guardar cambios</button>

<div id="fechas">üìÇ Seleccion√° un archivo .txt primero</div>
<hr>

<script>
const toggleBtn = document.getElementById("toggleDark");
toggleBtn.addEventListener("click", () => {
  document.body.classList.toggle("dark");
  toggleBtn.textContent = document.body.classList.contains("dark") ? "‚òÄÔ∏è Modo Claro" : "üåô Modo Oscuro";
});

const fileButton = document.getElementById("fileButton");
const fileInput = document.getElementById("fileInput");
const editor = document.getElementById("editor");
const updateButton = document.getElementById("updateButton");
const saveButton = document.getElementById("saveButton");

fileButton.addEventListener("click", () => fileInput.click());

const materiaLinks = {
  "Matematica aplicada II": [
    { text: "Presentaci√≥n y avisos", href: "https://campus.udc.edu.ar/course/view.php?id=1399" },
    { text: "Clase virtual", href: "https://meet.google.com/xeo-hwca-dhx?pli=1&authuser=1" }
  ],
  "Paradigmas de Programaci√≥n": [
    { text: "General", href: "https://campus.udc.edu.ar/course/view.php?id=1398&section=0" },
    { text: "Reuniones sincr√≥nicas", href: "https://campus.udc.edu.ar/mod/bigbluebuttonbn/view.php?id=63001" }
  ],
  "T√©cnicas Avanzadas de Programaci√≥n": [
    { text: "Introducci√≥n", href: "https://campus.udc.edu.ar/course/view.php?id=1395&section=0" },
    { text: "Reunion virtual", href: "https://campus.udc.edu.ar/mod/bigbluebuttonbn/view.php?id=62878" }
  ],
  "Arquitectura y Sistemas Operativos": [
    { text: "Introducci√≥n", href: "https://campus.udc.edu.ar/course/view.php?id=1383&section=2" },
    { text: "Virtual", href: "https://campus.udc.edu.ar/mod/bigbluebuttonbn/view.php?id=79996" }
  ]
};

function procesarContenido(contenido) {
  const secciones = {};
  let materiaActual = null;
  const lineas = contenido.split(/\r?\n/);
  lineas.forEach(linea => {
    linea = linea.trim();
    if (!linea || linea.startsWith("#") || linea.startsWith("//")) return;
    const matchMateria = linea.match(/^\[(.+?)\]$/);
    if(matchMateria){
      materiaActual = matchMateria[1].replace(/\)$/, "").trim();
      secciones[materiaActual] = [];
    } else if(materiaActual){
      const matchFecha = linea.match(/(\d{2})\/(\d{2})/);
      const dia = matchFecha ? parseInt(matchFecha[1],10) : 99;
      const mes = matchFecha ? parseInt(matchFecha[2],10) : 99;

      let clase = "";
      const textoLower = linea.toLowerCase();
      if(textoLower.includes("tp") || textoLower.includes("trabajo")) {
        clase = (textoLower.includes("entregado") || textoLower.includes("finalizado")) ? "tp-entregado" : "tp";
      }
      if(textoLower.includes("parcial") || textoLower.includes("final") || textoLower.includes("examen")) {
        clase = "examen";
      }

      secciones[materiaActual].push({ texto: linea, dia, mes, clase });
    }
  });

  let html = "";
  for(const materia in secciones){
    html += `<div class="materia"><h4>${materia}</h4>`;
    if(materiaLinks[materia]){
      materiaLinks[materia].forEach(btn => {
        html += `<a target="_blank" href="${btn.href}">${btn.text}</a>`;
      });
    }
    const items = secciones[materia];
    items.sort((a,b) => (a.mes - b.mes) || (a.dia - b.dia));
    html += `<div class="eventos"><ul>`;
    items.forEach(i => { html += `<li class="${i.clase}">${i.texto}</li>`; });
    html += `</ul></div></div>`;
  }
  document.getElementById("fechas").innerHTML = html;
}

// Leer archivo
fileInput.addEventListener("change", function() {
  const file = this.files[0];
  if (!file) return;
  const reader = new FileReader();
  reader.onload = e => {
    editor.value = e.target.result;
    editor.disabled = false;
    updateButton.disabled = false;
    saveButton.disabled = false;
    procesarContenido(editor.value);
  };
});

// Bot√≥n actualizar
updateButton.addEventListener("click", () => {
  procesarContenido(editor.value);
});

// Bot√≥n guardar cambios en un nuevo archivo
saveButton.addEventListener("click", () => {
  const blob = new Blob([editor.value], { type: "text/plain;charset=utf-8" });
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = "UDC Fechas Modificado.txt";
  a.click();
  URL.revokeObjectURL(url);
});
</script>

</body>
</html>
